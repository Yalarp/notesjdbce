# 12_Request_Processing_Pipeline â€“ MCQs

## EASY MCQs

### Q1. What is the fundamental component that makes up the Request Processing Pipeline?
A. Controllers
B. Middleware
C. Views
D. Models

<details>
<summary><strong>Answer</strong></summary>
**Correct Answer:** B
**Explanation:**
The pipeline is constructed by chaining together multiple Middleware components (request delegates) that process the request in sequence.
</details>

### Q2. In the pipeline, how does a middleware pass control to the next middleware?
A. `return;`
B. `await next();`
C. `continue;`
D. `goto next;`

<details>
<summary><strong>Answer</strong></summary>
**Correct Answer:** B
**Explanation:**
The `next` parameter is a delegate. Invoking `await next()` calls the subsequent middleware in the pipeline chain.
</details>

### Q3. Which method is used to register a **Terminal Middleware** (one that does NOT call next)?
A. `app.Use()`
B. `app.Run()`
C. `app.Map()`
D. `app.Next()`

<details>
<summary><strong>Answer</strong></summary>
**Correct Answer:** B
**Explanation:**
By convention, `app.Run()` is used to define terminal middleware because it does not receive a `next` delegate parameter and thus cannot pass control forward.
</details>

### Q4. If Middleware A calls `await next()`, code written **after** that line runs when?
A. Immediately.
B. Before the next middleware starts.
C. After all subsequent middleware components have returned (during the response phase).
D. Never.

<details>
<summary><strong>Answer</strong></summary>
**Correct Answer:** C
**Explanation:**
Middleware wraps the subsequent pipeline. The code before `next()` handles the incoming request. The code after `next()` handles the outgoing response as the stack unwinds.
</details>

### Q5. What happens if a middleware does NOT call `next()`?
A. The server crashes.
B. The pipeline keeps running.
C. The pipeline is "short-circuited"; subsequent middleware are not executed.
D. It loops back to the start.

<details>
<summary><strong>Answer</strong></summary>
**Correct Answer:** C
**Explanation:**
Short-circuiting is intentional (e.g., serving a static file, or denying auth). It stops downstream processing and immediately starts the response phase back up the stack.
</details>

---

## MEDIUM MCQs

### Q6. Why is the **Order of Registration** of middleware critical?
A. It isn't critical.
B. Because middleware executes in the order they are added. For example, Authentication must run before Authorization to identify the user first.
C. It sorts alphabetically.
D. It is random.

<details>
<summary><strong>Answer</strong></summary>
**Correct Answer:** B
**Explanation:**
The pipeline is linear. If you put `UseAuthorization` before `UseAuthentication`, the authorization check will fail because the user identity hasn't been established yet.
</details>

### Q7. Consider the sequence: `Middleware1 -> next() -> Middleware2`. If Middleware2 throws an exception, where can Middleware1 catch it?
A. It cannot catch it.
B. By wrapping the `await next()` call in a `try-catch` block.
C. In the `Main` method.
D. In the constructor.

<details>
<summary><strong>Answer</strong></summary>
**Correct Answer:** B
**Explanation:**
This is how `UseExceptionHandler` works. It sits at the top of the pipeline and wraps `next()` in a try-catch to handle errors occurring in any downstream middleware.
</details>

### Q8. Which object handles the HTTP processing in a Request Delegate?
A. `HttpContext`
B. `HttpRequest`
C. `HttpResponse`
D. `HttpServer`

<details>
<summary><strong>Answer</strong></summary>
**Correct Answer:** A
**Explanation:**
`HttpContext` aggregates everything about the current transaction, including the Request, Response, User, Session, etc.
</details>

### Q9. What logic typically goes in the "Response Phase" (after `await next()`)?
A. Routing logic.
B. Logging response times, modifying response headers, or auditing.
C. Auth checks.
D. Database queries.

<details>
<summary><strong>Answer</strong></summary>
**Correct Answer:** B
**Explanation:**
Since the response is generated by downstream middleware, the "after" phase is used to inspect or modify that response before it leaves the server.
</details>

### Q10. Why is `UseStaticFiles` usually placed early in the pipeline?
A. Because it is slow.
B. To avoid the overhead of Routing, Authentication, and MVC processing for simple file requests (images, css). If a file is found, it short-circuits.
C. It must be last.
D. It depends on the file size.

<details>
<summary><strong>Answer</strong></summary>
**Correct Answer:** B
**Explanation:**
Performance optimization. If a user asks for `logo.png`, there is no need to authenticate them or verify routes. Just serve the file and return.
</details>

---

## HARD MCQs

### Q11. Can you modify the Response **after** `next()` returns if the response has already started sending?
A. Yes, always.
B. No, attempting to modify headers or status code after the response has started (e.g., body bytes written to network) typically throws an exception.
C. Yes, but only headers.
D. Only in Development.

<details>
<summary><strong>Answer</strong></summary>
**Correct Answer:** B
**Explanation:**
Once the HTTP headers are flushed to the client, they cannot be changed. You can check `HttpContext.Response.HasStarted` to verify.
</details>

### Q12. How is `MapControllerRoute` (Endpoint Middleware) different from older `UseMvc`?
A. It is slower.
B. Endpoint Routing separates "Route Matching" (`UseRouting`) from "Endpoint Execution" (`UseEndpoints`/`Map...`). This allows middleware between them (like Auth) to know *which* endpoint was selected before it runs.
C. It is the same.
D. It only works for APIs.

<details>
<summary><strong>Answer</strong></summary>
**Correct Answer:** B
**Explanation:**
Modern pipeline: `UseRouting` (finds the endpoint) -> `UseAuth` (checks permissions for that specific endpoint) -> `MapControllerRoute` (executes the endpoint).
</details>

### Q13. In the diagram `M1 -> M2 -> M3 (Terminal)`, which middleware code executes LAST?
A. M1 (Before next)
B. M3
C. M1 (After next)
D. M2 (After next)

<details>
<summary><strong>Answer</strong></summary>
**Correct Answer:** C
**Explanation:**
The stack unwinds. Order: M1_Start, M2_Start, M3_Run, M2_End, M1_End. The "After next" code in M1 is the very last step before sending to client.
</details>

### Q14. What happens if you put `app.Run(...)` at the top of your pipeline?
A. It works fine.
B. It becomes the only middleware that runs. Since `Run` is terminal, it won't call next, so no subsequent middleware (Routing, StaticFiles, etc.) will ever execute.
C. It errors.
D. It is ignored.

<details>
<summary><strong>Answer</strong></summary>
**Correct Answer:** B
**Explanation:**
Terminal middleware blocks downstream flow. Placing it first effectively disables the rest of the application.
</details>

### Q15. Is Middleware created per-request or once per app lifetime (by default)?
A. Per-request.
B. Once (Singleton). The same middleware instance is reused for all requests (for standard `Use` delegates).
C. Scoped.
D. Transient.

<details>
<summary><strong>Answer</strong></summary>
**Correct Answer:** B
**Explanation:**
Standard middleware pipeline is built once at startup. The delegates are cached. This is why you cannot inject Scoped services into the *Constructor* of a middleware class (captive dependency), you must inject them into the `Invoke` method.
</details>
